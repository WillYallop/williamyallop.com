<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta content="width=device-width,initial-scale=1" name="viewport"><link href="../../css/main.css" rel="stylesheet"><title>@functionalities/mediakit | William Yallop</title><meta content="MediaKit is a backend utility package for processing, saving, getting and streaming images, files and video! We support both local and AWS S3 for storage." name="description"><meta content="@functionalities/mediakit | William Yallop" name="twitter:title"><meta content="MediaKit is a backend utility package for processing, saving, getting and streaming images, files and video! We support both local and AWS S3 for storage." name="twitter:description"><meta content="@functionalities/mediakit | William Yallop" property="og:title"><meta content="MediaKit is a backend utility package for processing, saving, getting and streaming images, files and video! We support both local and AWS S3 for storage." property="og:description"><script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "Project",
        "name": "@functionalities/mediakit",
        "description": "MediaKit is a backend utility package for processing, saving, getting and streaming images, files and video! We support both local and AWS S3 for storage.",
        "url": "https://www.npmjs.com/package/@functionalities/mediakit",
        "image": "functionalities/mediakit_thumbnail.jpg",
        "author": {
            "@type": "Person",
            "name": "William Yallop"
        },
        "dateCreated": "2022-08-20T00:00:00.000Z", 
        "dateModified": "2022-10-13T00:00:00.000Z",
        "datePublished": "2022-09-24T00:00:00.000Z",
        "keywords": "TypescriptExpressAWS S3Sharp"
    }</script><meta content="Portfolio, Projects" name="keywords"><meta content="index, follow" name="robots"><meta content="William Yallop" name="author"><meta content="summary_large_image" name="twitter:card"><meta content="https://williamyallop.com/static-images/card.jpg" name="twitter:image"><meta content="https://williamyallop.com/static-images/card.jpg" property="og:image"><meta content="https://williamyallop.com" property="og:url"><meta content="William Yallop" property="og:site_name"><meta content="website" property="og:type"><script>window.addEventListener("DOMContentLoaded", function () { document.body.classList.remove('preload'); });</script></head><body class="preload" data-toggler-receiver="navigtion-sidebar"><div class="nav-sidebar" data-toggler-receiver="navigtion-sidebar"><div class="nav-sidebar__inner"><div><div class="l--f l--f-a-c"><div class="nav-sidebar__pp"><picture class=""><source srcset="../../images/8ca55ab4-0589-492d-aebb-e4d4df08c7e8-300.avif" type="image/avif"><source srcset="../../images/b7229b72-1f1c-4291-852a-8f2fadb2100e-300.webp" type="image/webp"><img alt="" loading="lazy" src="../../images/1ac86ef2-c224-417e-9f62-a8755549df43-300.jpeg"></picture></div><div class="l--f l--f-d-c"><author class="t--b t--medium">William Yallop</author><span>Web Developer</span></div></div><nav class="l--bm-t-l nav-sidebar__nav"><ul><li><a href="/">Projects</a></li><li><a href="/blogs">Blogs</a></li></ul></nav></div><div class="nav-sidebar__footer-link"><a href="https://github.com/WillYallop" rel="noreferrer" target="_blank" aria-label="My Github"><svg viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252a250.7 250.7 0 0 0 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9a94.5 94.5 0 0 1 2.6-67.9c20.9-6.5 69 27 69 27a235 235 0 0 1 125.6 0s48.1-33.6 69-27a94.4 94.4 0 0 1 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a><a href="https://www.linkedin.com/in/william-yallop-633429184/" rel="noreferrer" target="_blank" aria-label="My LinkedIn"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M100.3 448H7.4V148.9h92.9zM53.8 108.1A54.2 54.2 0 0 1 0 53.8a53.8 53.8 0 0 1 107.6 0 54.2 54.2 0 0 1-53.8 54.3zM447.9 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.7V148.9h89v40.8h1.3c12.4-23.5 42.7-48.3 88-48.3 94 0 111.2 61.9 111.2 142.3V448z"/></svg></a></div></div></div><button aria-label="Toggle navigation bar" class="nav-sidebar__toggle" data-toggler="navigtion-sidebar"><span class="sr-only">Toggle navigation bar</span> <svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 96a32 32 0 0 1 32-32h384a32 32 0 1 1 0 64H32A32 32 0 0 1 0 96zm0 160a32 32 0 0 1 32-32h384a32 32 0 1 1 0 64H32a32 32 0 0 1-32-32zm448 160a32 32 0 0 1-32 32H32a32 32 0 1 1 0-64h384a32 32 0 0 1 32 32z"/></svg></button><main class="layout-main" data-toggler-receiver="navigtion-sidebar"><div class="layout-main__inner"><div class="l--f l--f-a-c project-hero-root__back"><a href="/" class="l--f l--f-a-c"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg> <span>Back to Projects</span></a></div><div class="l--f l--f-j-fe l--sp-h l--sp-th project-hero-root__top-bar"><a href="https://www.npmjs.com/package/@functionalities/mediakit" rel="noreferrer" target="_blank" class="btn-style btn-style__icon btn-style__icon--npm"><svg viewBox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M288 288h-32v-64h32v64zm288-128v192H288v32H160v-32H0V160h576zm-416 32H32v128h64v-96h32v96h32V192zm160 0H192v160h64v-32h64V192zm224 0H352v128h64v-96h32v96h32v-96h32v96h32V192z"/></svg> </a><a href="https://github.com/WillYallop/functionalities/tree/main/packages/mediakit" rel="noreferrer" target="_blank" class="btn-style btn-style__icon btn-style__icon--github"><svg viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></a></div><section class="project-hero-root"><div class="l--sp-h l__wrapper l__wrapper--sw-m"><div class="l__wrapper l--sp-bh l--sp-th l__wrapper--bw-l project-hero-root__textarea"><h1>@functionalities/mediakit</h1><p>MediaKit is a backend utility package for processing, saving, getting and streaming images, files and video! We support both local and AWS S3 for storage.</p></div><div class="l--f l--f-j-c l--sp-b project-hero-root__technologies"><ul class="l--f l--f-j-c l--f-w-w"><li>Typescript</li><li>Express</li><li>AWS S3</li><li>Sharp</li></ul></div><div class="project-hero-root__preview"><picture class=""><source srcset="../../images/46a35f8c-2afb-40be-84a7-392272c5ecab-1200.avif" type="image/avif"><source srcset="../../images/722788ad-2d78-4754-9af8-37179c9bc79d-1200.webp" type="image/webp"><img alt="" loading="" src="../../images/5c5b4b72-1466-4dbd-a736-3f5681325707-1200.jpeg"></picture></div></div></section><section class="l--sp-h l__wrapper l__wrapper--sw-m l--sp-b l--sp-t"><div class="t__textarea"><blockquote><p>For exmaples visit the repo and go to /apps/playground-api and look at the local and s3 controllers.</p></blockquote><p>MediaKit is a backend utility package for processing, saving, getting and streaming images, files and video! We support both local and AWS S3 to store files processed with MediaKit.</p><p>Alongside the MediaKit class that is exported as default, there is an ImageKit and VideoKit class. These will be your main entry point for handling images and videos. They are responsible for injesting and processing their corresponding file type.</p><p>The MediaKit class is how you will save, delete, get and stream files.</p><h2>Install</h2><pre><code>npm install @functionalities/mediakit --save
</code></pre><h2>Initialise MediaKit</h2><p>Initialise a MediaKit instance, passing down config depending on how you wish to store your files.</p><pre><code class="language-typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> localInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MediaKit</span>({
  <span class="hljs-attr">storeMethod</span>: <span class="hljs-string">&quot;local&quot;</span>,
  <span class="hljs-attr">localOptions</span>: {
    <span class="hljs-attr">directory</span>: <span class="hljs-string">&quot;./uploads&quot;</span>,
  },
});
</code></pre><blockquote><p>Local Store Exmaple</p></blockquote><pre><code class="language-typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> s3Instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MediaKit</span>({
  <span class="hljs-attr">storeMethod</span>: <span class="hljs-string">&quot;s3&quot;</span>,
  <span class="hljs-attr">s3Options</span>: {
    <span class="hljs-attr">bucket</span>: <span class="hljs-string">&quot;bucket&quot;</span>,
    <span class="hljs-attr">region</span>: <span class="hljs-string">&quot;eu-central-1&quot;</span>,
    <span class="hljs-attr">accessKeyId</span>: <span class="hljs-string">&quot;&quot;</span>,
    <span class="hljs-attr">secretAccessKey</span>: <span class="hljs-string">&quot;&quot;</span>,
  },
});
</code></pre><blockquote><p>AWS S3 Store Example</p></blockquote><h3>Public methods</h3><ul><li>save</li><li>delete</li><li>get</li><li>stream</li><li>streamVideo</li></ul><h2>ImageKit</h2><p>The ImageKit is responsible for injesting images to process and save. All images injested with an instance of this class will be process with the config defined in it.</p><pre><code class="language-typescript"><span class="hljs-comment">// Create a new instance</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">IKInstance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageKit</span>({
  <span class="hljs-attr">keyPrefix</span>: <span class="hljs-string">&quot;example_&quot;</span>,
});
</code></pre><p>You can injest an image with the MediaKit instance. This will return an Image class instance. With this you can then process it.</p><pre><code class="language-typescript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Image</span> = <span class="hljs-keyword">await</span> <span class="hljs-title class_">IKInstance</span>.<span class="hljs-title function_">injest</span>(file.<span class="hljs-property">data</span>, file.<span class="hljs-property">name</span>); <span class="hljs-comment">// blob, string</span>
<span class="hljs-keyword">await</span> <span class="hljs-title class_">Image</span>.<span class="hljs-title function_">process</span>();
</code></pre><p>Once you have injested and process all of the images you need in this ImageKit instance, you can then save it using the MediaKit.save method. Depending on the store type you selected for that controls where the file is stored. Once the file has been stored successfully, the ImageKit instance will have its injested images cleared.</p><pre><code class="language-typescript"><span class="hljs-comment">// store image kit</span>
<span class="hljs-keyword">const</span> storeImageKitRes = <span class="hljs-keyword">await</span> localInstance.<span class="hljs-title function_">save</span>(
  <span class="hljs-title class_">IKInstance</span>, <span class="hljs-comment">// your ImageKit instance, or VideoKit instance</span>
  <span class="hljs-string">&quot;/images&quot;</span> <span class="hljs-comment">// the subdirectory you wish it to be installed under</span>
);

<span class="hljs-comment">// response interface</span>
<span class="hljs-keyword">interface</span> MK_SaveSingleFileRes {
  <span class="hljs-attr">success</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  height?: <span class="hljs-built_in">number</span>;
  width?: <span class="hljs-built_in">number</span>;
  folder?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">files</span>: <span class="hljs-title class_">Array</span>&lt;{
    <span class="hljs-attr">saved</span>: <span class="hljs-built_in">boolean</span>;
    <span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">mime</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">extension</span>: <span class="hljs-built_in">string</span>;
  }&gt;;
}
</code></pre><blockquote><p>You will want to save this data in a database so you can stream, delete the image later on.</p></blockquote><h2>VideoKit</h2><p>The VideoKit is responsible for injesting videos. In the future this may have some form of processing.</p><pre><code class="language-typescript"><span class="hljs-comment">// New ImageKit Instance</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">VKInstance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VideoKit</span>({
  <span class="hljs-attr">keyPrefix</span>: <span class="hljs-string">&quot;example_&quot;</span>,
});
</code></pre><p>Similar to the ImageKit, when injesting a video into the VideoKit it will return a Video class instance. However, this currently has no public methods for processing it.</p><pre><code class="language-typescript"><span class="hljs-keyword">await</span> <span class="hljs-title class_">VKInstance</span>.<span class="hljs-title function_">injest</span>(file.<span class="hljs-property">tempFilePath</span>, file.<span class="hljs-property">mimetype</span>, file.<span class="hljs-property">name</span>); <span class="hljs-comment">// string, string, string</span>
</code></pre><p>Now you have injested all of the videos you want to save. You can use your MediaKit instance.</p><pre><code class="language-typescript"><span class="hljs-comment">// store video kit</span>
<span class="hljs-keyword">const</span> storeImageKitRes = <span class="hljs-keyword">await</span> localMediaKitInstance.<span class="hljs-title function_">save</span>(
  <span class="hljs-title class_">VideoKitInst</span>,
  <span class="hljs-string">&quot;/videos&quot;</span>
);

<span class="hljs-comment">// response interface</span>
<span class="hljs-keyword">interface</span> MK_SaveSingleFileRes {
  <span class="hljs-attr">success</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  height?: <span class="hljs-built_in">number</span>;
  width?: <span class="hljs-built_in">number</span>;
  folder?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">files</span>: <span class="hljs-title class_">Array</span>&lt;{
    <span class="hljs-attr">saved</span>: <span class="hljs-built_in">boolean</span>;
    <span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">mime</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">extension</span>: <span class="hljs-built_in">string</span>;
  }&gt;;
}
</code></pre><blockquote><p>You will want to save this data in a database so you can stream, delete the image later on.</p></blockquote><h2>Future</h2><ul><li>A FileKit with proccesing methods will be added.</li></ul></div></section></div></main><span class="footer-root__spacer"></span><footer class="l--f l--f-a-c footer-root l--bm-t-l l--f-j-c"><p>This site was built using&nbsp;<a href="https://github.com/WillYallop/static-site-generator" rel="noreferrer" target="_blank">@SSG</a>&nbsp;&&nbsp;<a href="https://github.com/WillYallop/functionalities" rel="noreferrer" target="_blank"> @functionalities</a>&nbsp;only!</p></footer>></body><script async src="../../js/index.js"></script></html>